<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TDEX Network Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TDEX Network Blog Atom Feed"><title data-react-helmet="true">BOTD#4: Trade | TDEX Network</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://dev.tdex.network/img/tdex-og-image.png"><meta data-react-helmet="true" name="twitter:image" content="https://dev.tdex.network/img/tdex-og-image.png"><meta data-react-helmet="true" property="og:url" content="https://dev.tdex.network/docs/specs/trade-protocol"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="BOTD#4: Trade | TDEX Network"><meta data-react-helmet="true" name="description" content="The Trade protocol defines the public interface of a non-custodial exchange on top of an Elements-based chain such as Liquid Network."><meta data-react-helmet="true" property="og:description" content="The Trade protocol defines the public interface of a non-custodial exchange on top of an Elements-based chain such as Liquid Network."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://dev.tdex.network/docs/specs/trade-protocol"><link data-react-helmet="true" rel="alternate" href="https://dev.tdex.network/docs/specs/trade-protocol" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dev.tdex.network/docs/specs/trade-protocol" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.1c87e427.css">
<link rel="preload" href="/assets/js/runtime~main.0e142996.js" as="script">
<link rel="preload" href="/assets/js/main.1dedbaeb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/tdex-logo.png" alt="TDEX logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tdex-logo.png" alt="TDEX logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Developer Portal</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tdex-network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Specifications</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/specs/index">BOTD#0: Index</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/specs/message-protocol">BOTD#1: Message</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/specs/transport-protocol">BOTD#2: Transport</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/specs/swap-protocol">BOTD#3: Swap</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/specs/trade-protocol">BOTD#4: Trade</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/specs/pool-protocol">BOTD#5: Pool</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/specs/CONTRIBUTING">Contributing to TDEX Specifications</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Trader</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Liquidity Provider</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Trade protocol</h1></header><p>The Trade protocol defines the public interface of a non-custodial exchange on top of an Elements-based chain such as <a href="https://liquid.net" target="_blank" rel="noopener noreferrer">Liquid Network</a>. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>The centralized exchange main business is providing a venue for <em>traders</em> and <em>market makers</em> to register their offers to buy and sell in an order-book. In order to execute the orders, both are required to deposit funds and trust the exchange as custodian.  </p><p><strong>TDEX</strong> aims to create an open network that connects <em>traders</em> and <em>market makers</em> directly to each other, without the need of a centralized custodian, exploiting the atomic swap capability of Elements-based chains for executing trades in a trustless fashion.</p><p>The <strong>market makers</strong> provide always-on endpoints and put liquidity in various asset pairs forming a specified interface called <strong>Market</strong>.  Each <em>Market</em> holds reserves of a <strong>base asset</strong> and a <strong>quote asset</strong>.</p><p>Anyone can become a <strong>liquidity provider</strong> and contribute with reserves in a non-custodial manner running an always-on endpoint to process trading requests. This is different than buying or selling; it requires depositing an equivalent value of both base and quote assets and select an automated market making strategy. </p><p>A <strong>trader</strong> connects to the provider using the <a href="/docs/specs/transport-protocol">secure transport defined in the BOTD #2</a>, fetches the current <em>market price</em> defined by the provider&#x27;s strategy and makes an atomic swap using the <a href="/docs/specs/swap-protocol">swap protocol defined in the BOTD #3</a>. Limit orders could be supported as well, delaying the time of execution of the swap proposal in the future.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="trade"></a>Trade<a class="hash-link" href="#trade" title="Direct link to heading">#</a></h2><ol><li>The <strong>Provider</strong> deposits two reserves for each asset forming a <em>Market</em>, defined as a pair of BASE ASSET and QUOTE ASSET, and expose a public reachable endpoint.</li><li>The <strong>Trader</strong> fetches from the <strong>Provider</strong> the list of supported pairs and linked provider&#x27;s fees.</li><li>The <strong>Trader</strong> passing a supported market in the request recognized by the hashes of two assets, fetches the current <strong>market rate</strong></li><li>The <strong>Trader</strong> proposes a new <strong>swap request</strong> using the price given and awaits for Provider&#x27;s response. The amounts in the swap request must not include the *<em>trading fees</em>, which must be explictly specified by the trader in the trade proposal message. The amounts in the swap request transaction, instead, must include the fees charged either on its inputs or outputs.</li><li>If the <strong>Provider</strong> accepts the terms will send back a <strong>swap accept</strong> message containing the partially signed transaction.</li><li>The <strong>Trader</strong> sends the signed transaction to finalize the trade using the <strong>swap complete</strong> message.</li><li>The <strong>Provider</strong> will finalize and broadcast the transaction to the network for on-chain settlement.</li></ol><blockquote><p>NOTICE: The Trader could skip point 6-7 and right away broadcast the transaction himself. Even if valid would be better for clients software to let the Provider be aware of the finalized transaction id rather than watch the blockchain to scan for known swaps.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="data-structures"></a>Data Structures<a class="hash-link" href="#data-structures" title="Direct link to heading">#</a></h3><ul><li>Service Interface</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly protobuf"><pre tabindex="0" class="prism-code language-protobuf codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">syntax = &quot;proto3&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">service TradeService {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc ListMarkets(ListMarketsRequest) returns (ListMarketsResponse) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    option (google.api.http) = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      post: &quot;/v1/markets&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc GetMarketBalance(GetMarketBalanceRequest) returns (GetMarketBalanceResponse) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    option (google.api.http) = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      post: &quot;/v1/market/balance&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      body: &quot;*&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc GetMarketPrice(GetMarketPriceRequest) returns (GetMarketPriceResponse) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    option (google.api.http) = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      post: &quot;/v1/market/price&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      body: &quot;*&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc PreviewTrade(PreviewTradeRequest) returns (PreviewTradeResponse) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    option (google.api.http) = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      post: &quot;/v1/market/preview&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      body: &quot;*&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc ProposeTrade(ProposeTradeRequest) returns (ProposeTradeResponse) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    option (google.api.http) = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      post: &quot;/v1/trade/propose&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      body: &quot;*&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc CompleteTrade(CompleteTradeRequest) returns (CompleteTradeResponse) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    option (google.api.http) = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      post: &quot;/v1/trade/complete&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      body: &quot;*&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>Messages </li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly protobuf"><pre tabindex="0" class="prism-code language-protobuf codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">message ListMarketsRequest {}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message ListMarketsResponse { repeated MarketWithFee markets = 1; }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message GetMarketBalanceRequest { Market market = 1; }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message GetMarketBalanceResponse { BalanceWithFee balances = 1; }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message GetMarketPriceRequest { Market market = 1; }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message GetMarketPriceResponse {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  double spot_price = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 min_tradable_amount = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message PreviewTradeRequest {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Market market = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  TradeType type = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 amount = 3;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string asset = 4;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message PreviewTradeResponse { repeated Preview previews = 1; }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message ProposeTradeRequest {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Market market = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  TradeType type = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SwapRequest swap_request = 3;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string fee_asset = 4;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 fee_amount = 5;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message ProposeTradeResponse {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SwapAccept swap_accept = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SwapFail swap_fail = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 expiry_time_unix = 3;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message CompleteTradeRequest {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SwapComplete swap_complete = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SwapFail swap_fail = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message CompleteTradeResponse {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string txid = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SwapFail swap_fail = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>Custom Types </li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly protobuf"><pre tabindex="0" class="prism-code language-protobuf codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">enum TradeType {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  TRADE_TYPE_BUY = 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  TRADE_TYPE_SELL = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message Fee {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  int64 basis_point = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Fixed fixed = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message Fixed {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  int64 base_fee = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  int64 quote_fee = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message Balance {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 base_amount = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 quote_amount = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message BalanceWithFee {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Balance balance = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Fee fee = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message Market {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string base_asset = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string quote_asset = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message MarketWithFee {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Market market = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Fee fee = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message Price {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  float base_price = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  float quote_price = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message Preview {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Price price = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Fee fee = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 amount = 3;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string asset = 4;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Balance balance = 5;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="glossary"></a>Glossary<a class="hash-link" href="#glossary" title="Direct link to heading">#</a></h2><ul><li><p><strong>Liquidity Provider</strong>: Holds reserves of pegged Bitcoin (eg. L-BTC) and an associated Elements asset in his non-custodial wallet, running automated market-making strategies both with or without an oracle. Providers are incentivized to be always on and need to expose a public reachable endpoint either via clearnet or using a <a href="https://2019.www.torproject.org/docs/tor-onion-service.html" target="_blank" rel="noopener noreferrer">Onion hidden service</a></p></li><li><p><strong>Market</strong>: A single provider putting liquidity into an asset pair forms a market defines as <strong>BASE_ASSET-QUOTE_ASSET</strong>. Multiple markets can co-exist, although this is less beneficial for signaling offers to traders. </p></li><li><p><strong>Trader</strong>: Proposes new swaps using the provider&#x27;s market rate. A trader can come and go, he only needs to support the <a href="/docs/specs/swap-protocol">swap protocol defined in the BOTD #3</a> and he can swap between the two assets in the <strong>Market</strong> in either direction by adding to the liquidity reserve of one and withdrawing from the reserve of the other. Traders can either connect directly to a <strong>provider</strong> if they already know the endpoint.</p></li><li><p><strong>Pool</strong>: Providers can register into a distributed service mesh with other providers pooling together liquidity. This acts as a first responder for traders to lookup for provider&#x27;s aggregated offers. A provider could run alone OR in a pool, but not both at the same time with the same reserves.</p></li><li><p><strong>Automated Market Making</strong>: A liquidity provider has full control over the market making strategy to apply needed to calculate the <strong>market rate</strong> at which to accept trades. That being said, there is a possibility to apply an automated market-making relying only on the reserves balances and the amount requested by the trader, without the need to connect to an external price feed. One of the most famous algorithms is called <em>constant product market-making</em>. In short, this model generates a full order-book based on an initial price for the market. Every transaction that occurs on this market will adjust the prices of the market accordingly. It&#x27;s a basic supply and demand automated market making system. </p></li><li><p><strong>Trading fee</strong>: A small percentage of the amount of the trade can be taken out by the provider and added to the reserves, besides the network fees. Since the provider is conveniently in charge of paying network fees, and also to discourage low-amount trades, he could also charge an additional fixed fee amount to the trade to be partially reimbursed for this expense. While the <em>BASE_ASSET-QUOTE_ASSET</em> reserve ratio is constantly shifting, fees make sure that the total combined reserve size increases with every trade.
Guaranteed arbitrage opportunities from price fluctuations should push a steady flow of transactions through the system and increase the amount of fee revenue generated.  On the trader side, he can decide to pay the trading fees in either the base or the quote asset of a market. When making a trade proposal, the fees must be explictly specified in the request message along with the swap request one. The swap request&#x27;s amounts must not include the trading fees while they must be charged to the amounts of the transaction. It is duty of both parties to make sure the amounts presented in the trade proposal request message match those of the transaction they cooperatively build, sign and broadcast.  The trading fees must be either added or substracted to amount_p/amount_r of the swap request depending on the trade type and the asset in which fees are going to be payed. The following table resume all possible cases:</p><table><thead><tr><th>Trade type</th><th>Fee asset</th><th align="center">Sign</th></tr></thead><tbody><tr><td>BUY</td><td>base asset</td><td align="center">-</td></tr><tr><td>BUY</td><td>quote asset</td><td align="center">+</td></tr><tr><td>SELL</td><td>base asset</td><td align="center">+</td></tr><tr><td>SELL</td><td>quote asset</td><td align="center">-</td></tr></tbody></table></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tdex-network/dev-portal/edit/master/docs/specs/04-trade-protocol.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/specs/swap-protocol"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« BOTD#3: Swap</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/specs/pool-protocol"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">BOTD#5: Pool Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#trade" class="table-of-contents__link">Trade</a><ul><li><a href="#data-structures" class="table-of-contents__link">Data Structures</a></li></ul></li><li><a href="#glossary" class="table-of-contents__link">Glossary</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">DOCS</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/specs/index">Specifications</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/trader/intro">Trader</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/provider/intro">Liquidity Provider</a></li></ul></div><div class="col footer__col"><div class="footer__title">COMMUNITY</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/tdexnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">MORE</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/tdex-network" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 TDEX Network. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0e142996.js"></script>
<script src="/assets/js/main.1dedbaeb.js"></script>
</body>
</html>